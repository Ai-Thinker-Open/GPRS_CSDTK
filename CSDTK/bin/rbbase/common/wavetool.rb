require "win32/sound"



def savepcm(filename,buffer)
	
    wave_header= [0x52, 0x49, 0x46, 0x46, 0x32, 0x00, 0x00, 0x00,
    0x57, 0x41, 0x56, 0x45, 0x66, 0x6d, 0x74, 0x20,
    0x12, 0x00, 0x00, 0x00, 0x01, 0x00, 0x01, 0x00,
    0x40, 0x1f, 0x00, 0x00, 0x80, 0x3e, 0x00, 0x00,
    0x02, 0x00, 0x10, 0x00, 0x00, 0x00, 0x66, 0x61,
    0x63, 0x74, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x64, 0x61, 0x74, 0x61]
    
    File.open(filename,"wb") { |f|
    	f.write(wave_header.pack("C*"))
    	f.write([buffer.size].pack("V"))
    	f.write(buffer.pack("C*"))
    }

end

def playWavBuffer(buffer,tmpname="tmpwav.wav")
    savepcm(tmpname,buffer)
    Sound.play(tmpname)
end

